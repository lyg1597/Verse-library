A0 = [-3.01543266, -3.79855661,  1.76747326;-0.24781885,  0.94346251, -4.79410501;-4.05235718,  1.73291361,  4.75043987];
A1 = [ 1.29285307,  4.99714053, -3.54401244; 0.01084965, -3.78005681,  3.23872005; 0.91658178,  1.25065622, -0.192326  ];
A2 = [-1.6151233 ,  4.62729827, -4.28605077; 0.73316211,  0.34576438, -3.50565487;-3.86152252,  0.33095721,  0.57806628];
A3 = [-3.69068301,  0.21493028,  1.19091545; 4.80865679,  4.20318553,  4.54577808; 4.84704884,  0.93460586, -2.51891471];

x0 = [-1.33504336; 2.19668654; 9.12047933];

t0 = 0:0.001:0.5;
t1 = 0:0.001:0.5;

[T0,T1] = meshgrid(t0,t1);

ct_array = zeros(size(T0));

for i=1:length(t1)
    for j=1:length(t0)
        xt = expm(A3*T1(i,j))*expm(A2*T0(i,j))*x0;
        ct_array(i,j) = xt'*xt;
    end
end

surf(T0,T1,ct_array,'edgecolor','none')
hold on
contour3(T0,T1,ct_array,100, '-k', 'LineWidth',1.5)                   % Add Contours
hold off
